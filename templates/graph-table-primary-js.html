<script type="text/javascript">
  google.load("visualization", "1", {packages:["corechart","table"]});
  google.setOnLoadCallback(drawChart);
  
  function drawChart() {
    {% if dfl_data|length() > 0 %}
      var dfl_chart_data = google.visualization.arrayToDataTable([
        ['Name', '%'],
        {% for d in dfl_data %}{% if d.percent_votes|int() > 5 %}['{{d['candidate_name']}}',{{d['percent_votes']|int()}}],{% endif %} {% endfor %}]);

      var dfl_table_data = google.visualization.arrayToDataTable([
          ['Candidate','Party','Votes','%'],
          {% for d in dfl_data %}{% if d.candidate_votes|int() > 50 %}['{{d['candidate_name']}}','{{d['party_id']}}',{{d['candidate_votes']|int()}},'{{d['percent_votes'][:5]}}'],{% endif %}{% endfor %}]);

      var dfl_chart_options = {
        title: '{{year}} DFL {% if active == 'ushouse' %}CD{% endif %}{{office}} Vote %',
        legend: {position: 'none'},
        fontSize: 14,
        vAxis: {maxValue: 80, minValue: 0},
        allowHtml: true,
      };

      var dfl_table_options = {fontSize: 14,
        allowHtml: true,
      };

      var dflchart = new google.visualization.ColumnChart(document.getElementById('{{year}}_dfl_chart_div'));
      var dfltable = new google.visualization.Table(document.getElementById('{{year}}_dfl_table_div'));
      dfltable.draw(dfl_table_data, dfl_table_options);
      dflchart.draw(dfl_chart_data, dfl_chart_options);

    {% endif %}

    {% if gop_data|length() > 0 %}
      var gop_chart_data = google.visualization.arrayToDataTable([
        ['Name', '%'],
        {% for d in gop_data %}{% if d.percent_votes|int() > 5 %}['{{d['candidate_name']}}',{{d['percent_votes']|int()}}],{% endif %} {% endfor %}]);

      var gop_table_data = google.visualization.arrayToDataTable([
          ['Candidate','Party','Votes','%'],
          {% for d in gop_data %}{% if d.candidate_votes|int() > 50 %}['{{d['candidate_name']}}','{{d['party_id']}}',{{d['candidate_votes']|int()}},'{{d['percent_votes'][:5]}}'],{% endif %}{% endfor %}]);

      var gop_chart_options = {
        title: '{{year}} GOP {% if active == 'ushouse' %}CD{% endif %}{{office}} Vote %',
        legend: {position: 'none'},
        fontSize: 14,
        vAxis: {maxValue: 80, minValue: 0},
        allowHtml: true,
      };

      var gop_table_options = {fontSize: 14,
        allowHtml: true,
      };

      var dflchart = new google.visualization.ColumnChart(document.getElementById('{{year}}_gop_chart_div'));
      var dfltable = new google.visualization.Table(document.getElementById('{{year}}_gop_table_div'));
      dfltable.draw(gop_table_data, gop_table_options);
      dflchart.draw(gop_chart_data, gop_chart_options);

    {% endif %}

    {% if ip_data|length() > 0 %}
      var ip_chart_data = google.visualization.arrayToDataTable([
        ['Name', '%'],
        {% for d in ip_data %}{% if d.percent_votes|int() > 5 %}['{{d['candidate_name']}}',{{d['percent_votes']|int()}}],{% endif %}{% endfor %}]);

      var ip_table_data = google.visualization.arrayToDataTable([
          ['Candidate','Party','Votes','%'],
          {% for d in ip_data %}{% if d.candidate_votes|int() > 50 %}['{{d['candidate_name']}}','{{d['party_id']}}',{{d['candidate_votes']|int()}},'{{d['percent_votes'][:5]}}'],{% endif %}{% endfor %}]);

      var ip_chart_options = {
        title: '{{year}} IP {% if active == 'ushouse' %}CD{% endif %}{{office}} Vote %',
        legend: {position: 'none'},
        fontSize: 14,
        vAxis: {maxValue: 80, minValue: 0},
        allowHtml: true,
      };

      var ip_table_options = {fontSize: 14,
        allowHtml: true,
      };

      var dflchart = new google.visualization.ColumnChart(document.getElementById('{{year}}_ip_chart_div'));
      var dfltable = new google.visualization.Table(document.getElementById('{{year}}_ip_table_div'));
      dfltable.draw(ip_table_data, ip_table_options);
      dflchart.draw(ip_chart_data, ip_chart_options);

    {% endif %}
    
  };
</script>